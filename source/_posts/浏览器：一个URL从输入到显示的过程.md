---
title: 浏览器：一个URL从输入到显示的过程
date: 2020-03-24 20:29:48
tags: 浏览器
category: 技术
---

![](https://github.com/chajianyuan/picture/blob/master/1651616595458_.pic.jpg?raw=true)

<!--more-->

过程简述：
1. 查找浏览器缓存，如果没找到则进行DNS解析
2. TCP三次握手
3. 发送http请求
4. 服务器处理请求并返回http报文
5. 浏览器解析渲染页面
6. TCP四次挥手

具体过程描述：

### 1、查找浏览器缓存，如果没有则进行 DNS 解析

当在浏览器中输入一个 URL 时，最开始要去浏览器缓存中查找，[浏览器缓存分为强缓存和协商缓存](https://chajianyuan.github.io/2019/10/20/%E6%B5%8F%E8%A7%88%E5%99%A8%EF%BC%9A%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6/)，强缓存指不需要向服务器发送请求，直接从缓存中读取资源，状态码为 200，协商缓存是指当强缓存失效后，浏览器携带缓存标识向服务器发送请求，如果资源没有改变就返回 304，更新缓存，如果资源改变就返回 200 和新的资源，如果浏览器中不存在缓存，就通过 DNS 服务器启动一个 DNS 查询，获得 URL 对应的 IP 地址

> 👂 这里我们讲一下`URL`的构成部分：
以`https://www.runoob.com/css/css-tutorial.html`为例
`URL`包含协议（`https`）、网络地址(`www.runoob.com`)、资源路径(`/css`)、文件名(`css-tutorial.html`)、动态参数
**· 协议：**指从该计算机获取资源的方式，一般有`Http、Https、Ftp、File`等协议，不同协议有不同的通讯内容格式，其中常用的就是[`Http`和`Https`](https://chajianyuan.github.io/2020/03/25/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%EF%BC%9Ahttp%E5%92%8Chttps/)。
**· 网络地址：**指连接网络上哪台计算机或服务器，可以是域名或IP地址，后面可能还带冒号+端口号，一般端口号都是默认的，比如Http的默认端口号是80，Https的默认端口号是443，如果使用默认的端口时，则URL上不需要带端口号；如果改变了默认端口号，则需要在URL上展示对应的端口号。
**· 资源路径：**指从服务器上获取哪一项资源的等级路径，用`/`分割。
**· 文件名：**指真正需要访问的文件名，有的URL直接以`/`结尾，则表示访问的是最后一层文件路径下的`index.html`或`default.html`文件
**· 动态参数：**指以`?`开始的参数，一般是需要传给服务端进行动态数据库查询的。

### 2、TCP 连接：TCP 三次握手🤝

- 第一次握手，由浏览器发起，告诉服务器我要发起请求了
- 第二次握手，由服务器发起，告诉浏览器，我已经准备接收了，你可以发送请求了
- 第三次握手，由浏览器发起，告诉服务器，我马上发送了，准备接收吧

**三次握手的目的**：防止已失效的连接请求报文段突然又传送到了服务器端，因而产生错误

### 3、发送 HTTP 请求

### 4、服务器处理请求并返回 HTTP 报文

### 5、浏览器解析渲染页面

1. 根据 HTML 解析 DOM 树
2. 根据 CSS 解析生成 CSS 规则树
3. 结合 DOM 树和 CSS 规则树，生成渲染树
4. 根据渲染树计算每一个节点的信息
5. 根据计算好的信息绘制页面

### 6、断开连接：TCP 四次挥手🙋

参照：[掘金：从 URL 输入到页面展现到底发生什么？](https://juejin.im/post/5bf3ad55f265da61682afc9b)
参照：[浏览器工作原理：从 URL 输入到页面展现到底发生了什么？](https://www.jianshu.com/p/d616d887953a)
